---
import BaseLayout from "@layouts/BaseLayout.astro";
import { styled as p } from "panda/jsx";
import { Image } from "astro:assets";
import Marker from "@/components/Marker.astro";
import { formatDate } from "@/lib/constants";
import { getContentList } from "@/lib/services/microcms";

const worksList = await getContentList("works", { fields: ["id", "title"] });
---

<BaseLayout>
  <p.div m="0 auto" w="100%">
    <Marker>
      <p.h1>Works</p.h1>
    </Marker>
  </p.div>

  <p.article py="10">
    <p.div
      display="grid"
      gap="8"
      gridTemplateColumns="repeat(auto-fill, minmax(300px, 1fr))"
      textAlign="center"
    >
      {
        worksList.contents.map(({ id, title, ogpImg, releaseDate }) => (
          <p.a
            key={id}
            bg="9u-gray"
            href={`/works/${id}`}
            position="relative"
            style={{
              viewTransitionName: `works-${id}`,
            }}
          >
            <Image
              alt={title}
              height={ogpImg.height}
              src={ogpImg.url}
              width={ogpImg.width}
            />
            <p.div
              _hover={{ opacity: "1" }}
              bg="9u-red1"
              color="9u-white"
              display="grid"
              h="100%"
              left="50%"
              opacity="0"
              placeContent="center"
              placeItems="center"
              position="absolute"
              top="50%"
              transform="translate(-50%, -50%)"
              transition="opacity 0.3s"
              w="100%"
            >
              <p.p fontSize="xl" fontWeight="bold">
                {title}
              </p.p>
              <p.p>{formatDate(new Date(releaseDate), "YYYY.MM")}</p.p>
            </p.div>
          </p.a>
        ))
      }
    </p.div>
  </p.article>
</BaseLayout>
